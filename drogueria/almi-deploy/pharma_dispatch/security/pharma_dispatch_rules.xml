<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- Regla de registro para que conductores vean solo sus propias rutas -->
        <record id="dispatch_route_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver solo sus propias rutas</field>
            <field name="model_id" ref="model_dispatch_route"/>
            <field name="domain_force">[('driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean solo sus propias líneas de ruta -->
        <record id="dispatch_route_line_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver solo sus propias líneas de ruta</field>
            <field name="model_id" ref="model_dispatch_route_line"/>
            <field name="domain_force">[('route_id.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean su propio perfil -->
        <record id="dispatch_driver_self_rule" model="ir.rule">
            <field name="name">Conductor: Ver solo su propio perfil</field>
            <field name="model_id" ref="model_dispatch_driver"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean solo sus propios vehículos asignados -->
        <record id="dispatch_vehicle_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver solo sus vehículos asignados</field>
            <field name="model_id" ref="model_dispatch_vehicle"/>
            <field name="domain_force">[('driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean las hojas de despacho asignadas a ellos -->
        <record id="dispatch_sheet_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver hojas de despacho asignadas</field>
            <field name="model_id" ref="model_dispatch_sheet"/>
            <field name="domain_force">[('driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean sus liquidaciones -->
        <record id="dispatch_settlement_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver sus liquidaciones</field>
            <field name="model_id" ref="model_dispatch_settlement"/>
            <field name="domain_force">[('sheet_id.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean sus hojas de cobranza -->
        <record id="dispatch_collection_sheet_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver sus hojas de cobranza</field>
            <field name="model_id" ref="model_dispatch_collection_sheet"/>
            <field name="domain_force">[('settlement_id.sheet_id.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean y editen sus líneas de cobranza -->
        <record id="dispatch_collection_line_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver y editar sus líneas de cobranza</field>
            <field name="model_id" ref="model_dispatch_collection_line"/>
            <field name="domain_force">[('collection_sheet_id.settlement_id.sheet_id.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean los pedidos de sus rutas -->
        <record id="sale_order_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver pedidos de sus rutas</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="domain_force">[('route_line_id.route_id.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean facturas de sus rutas -->
        <record id="account_move_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver facturas de sus rutas</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="domain_force">[('dispatch_sheet_ids.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla de registro para que conductores vean clientes (partners) de sus rutas -->
        <record id="res_partner_driver_rule" model="ir.rule">
            <field name="name">Conductor: Ver clientes de sus rutas</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[('sale_order_ids.route_line_id.route_id.driver_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_pharma_dispatch_driver'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</odoo>

